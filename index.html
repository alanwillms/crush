<!DOCTYPE html>
<html>
    <head>
    </head>
    <body style="margin:0; padding: 0; width: 100%; height: 100%">
        <canvas id="canvas" style="margin: 0 auto;"></canvas>
        <script src="fabric.min.js"></script>
        <script>
            var Canvas = this.__canvas = new fabric.Canvas(
                'canvas',
                {
                    hoverCursor: 'pointer',
                    selection: false
                }
            );

            Canvas.on(
                {
                    'object:moving': function(e) {
                        e.target.bringToFront();
                        e.target.set({
                            left: 1 + (Math.round((e.target.left-1) / 48) * 48),
                            top: 1 + (Math.round((e.target.top-1) / 48) * 48)
                        });
                    },
                    'object:modified': function(e) {
                        e.target.opacity = 1;
                    }
                }
            );

            var Game = function() {

                var tileSize = 48;
                var horizontalTiles = 15;
                var verticalTiles = 15;

                new Board(horizontalTiles, verticalTiles, tileSize);

                Canvas.setDimensions({
                    width: (horizontalTiles * tileSize) + 1,
                    height: (verticalTiles * tileSize) + 1
                });
            };

            var Piece = function() {

                var types = {
                    1: '#FF0000', // vermelho
                    2: '#0000FF', // azul
                    3: '#00FF00', // verde
                    4: '#FFFF00', // amarelo
                    5: '#FFCC00', // laranja
                    6: '#FF00FF', // roxo
                };

                this.type = Math.floor(Math.random() * 6) + 1;
                this.color = types[this.type];
            };

            var Board = function(width, height, size) {
                this.width = width;
                this.height = height;
                this.size = size;
                this.pieces = [];

                var __board = this;

                for (var row = 0; row < height; row++) {

                    var rowPieces = [];

                    for (var column = 0; column < width; column++) {

                        var piece = new Piece();
                        var top = row * size;
                        var left = column * size;

                        // Add piece
                        rowPieces.push(piece);

                        Canvas.add(
                            // Draw cell
                            new fabric.Rect({
                                top: top,
                                left: left,
                                width: size,
                                height: size,
                                fill: 'transparent',
                                stroke: '#000',
                                selectable: false
                            })
                        );

                        Canvas.add(
                            // Draw piece
                            new fabric.Circle({
                                top: top + 1,
                                left: left + 1,
                                radius: (size/2) - 1,
                                fill: piece.color,
                                hasControls: false,
                                hasBorders: false
                            })
                        );
                    }

                    this.pieces.push(rowPieces);
                }
            };

            new Game();
        </script>
    </body>
</html>